<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>クイズ参加画面</title>
</head>
<body>
  <h1>クイズ参加画面</h1>
  <div id="question">ここに問題が表示されます</div>
  <input id="name" type="text" placeholder="名前を入力" />
  <input id="answer" type="text" placeholder="解答を入力" />
  <button id="submit">送信</button>

  <script>
    const protocol = location.protocol === 'https:' ? 'wss' : 'ws';
    const socket = new WebSocket(`${protocol}://${location.host}/ws`);

    socket.addEventListener('open', () => {
      console.log('✅ WebSocket接続完了');
    });

    socket.addEventListener('message', (event) => {
      const data = JSON.parse(event.data);
      if (data.type === 'question') {
        document.getElementById('question').textContent = data.question;
      }
    });

    document.getElementById('submit').addEventListener('click', () => {
      const name = document.getElementById('name').value.trim();
      const answer = document.getElementById('answer').value.trim();
      if (!name || !answer) return alert('名前と解答を入力してください');

      const payload = {
        type: 'answer',
        name: name,
        answer: answer,
        correct: false, // 正誤判定は後で行う（ここでは仮で false）
        time: 0 // 解答時間も後で実装予定
      };

      socket.send(JSON.stringify(payload));
      document.getElementById('answer').value = '';
    });
  </script>
</body>
</html>
